<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>

	
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Request - SAL Item</title>

 <script type="text/javascript"> 
<!--

function CheckAll()
{
	for (var i=0;i<document.requestform.elements.length;i++)
	{
		var e = document.requestform.elements[i];
		if (e.name != 'allbox')
			e.checked = document.requestform.allbox.checked;
    }
}
function UnCheckAll()
{
        for (var i=0;i<document.requestform.elements.length;i++)
        {
                var e = document.requestform.elements[i];
                if (e.name != 'allbox')
                        e.checked = false;
    }
}

//-->
</script>
   
    <link href="/stylesheets/request-forms.css" rel="stylesheet" type="text/css">
</head>
<body>

<div id="header">
<a href="#formstart" class="off_screen">Skip to form</a>

<a id="SULAIR" title="SULAIR Home" href="http://www-sul.stanford.edu/index.html">&nbsp;</a>
<div class="links"><a href="http://library.stanford.edu/socrates">SOCRATES (SU CATALOG)</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://library.stanford.edu/images/main_l2/globals_ejournals.gif">E-JOURNALS</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://library.stanford.edu/search_form_main">SITE SEARCH</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://library.stanford.edu/ask_us/index.html">ASK US</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www-sul.stanford.edu/index.html">SULAIR HOME</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.stanford.edu/">SU HOME</a></div></div>


<div id="container">

		<!-- Parameter names need to match what's used in destination proc -->
		
		<h1><%= @requestdef[:title] %></h1>
		<% unless flash[:notice].blank?%>
			<div id="notification"><%= flash[:notice] %></div>
		<% end %>
		<%= error_messages_for 'request' %>

		<div class="opening">
		
		<p><%= @requestdef[:initial_text]%></p>
		
		</div>
			
		<% form_for(:request, @request, :url => { :action => 'create'}) do |f| %>			
	
			<%= f.hidden_field :req_type %>
			<%= f.hidden_field :home_lib %>	
			<%= f.hidden_field :current_loc %>		
			<%= f.hidden_field :item_id %>
			<%= f.hidden_field :due_date %>
			<%= f.hidden_field :bib_info %>
			<%= f.hidden_field :call_num %>
			<%= f.hidden_field :ckey %>

			<!-- Visible fields for record; some may be hidden above -->
			
			<dl>
			
			<% if @fields.has_key?('ckey') %>
			<dt><%= @fields['ckey'] %>:</dt>
			 	<dd><%= @request.ckey %></dd>
			 <% end %>
			 
			<% if @fields.has_key?('item_id') %>
			<dt><%= @fields['item_id'] %>:</dt>
			 	<dd><%= @request.item_id %></dd>
			<% end %>			 
			 
			<% if @fields.has_key?('call_num') %>		 
			<dt><%= @fields['call_num'] %>:</dt>
				 <dd><%= @request.call_num %></dd>
			<% end %>
			
			<% if @fields.has_key?('date') %>
			<dt><%= @fields['date'] %>:</dt>
				<dd> <%= Time::now() %></dd>
			<% end %>
			
			
			<% if @fields.has_key?('bib_info') %>
			<dt><%= @fields['bib_info'] %>:</dt>
				<dd><%= @request.bib_info %></dd>
			<% end %>
			
			</dl>
			
			<!-- User Info -->
			
			<a name="formstart"></a>
			
			<fieldset> <legend>Your Information</legend>
			
			<% if ! @is_authenticated %>
			<div id="autofill">If you have a SUNet ID, &raquo; <a href="<%= link_to_auth_request(@request) %>">login</a> &laquo; to auto-fill and enable more options.</div>
			<% end %>
			
			<%if @fields.has_key?('hold_recall') %>
				<dt><label for="request_hold_recall"><%= @fields['hold_recall'] %></label>:</dt>
				
				<dd><label><input name="request_type" type="radio" value="Hold" 
					<% if ! @is_autheticated %>
					checked="checked"
					<% end %>
					 >Hold</label>
					<label id="recallLabel" 
					<% if ! @is_authenticated %>					
					style="color: #666;"
					<% end %>
					>						
					<input name="request_type" id="request_type" type="radio" 
					<% if ! @is_authenticated %>
					disabled="disabled" 
					<% end %>
					value="Recall">
  					Recall 
					<% if ! @is_authenticated %>
					<span id="loginInstruction">(login to enable this option)</span>
					<% end %>
					</label></dd>

			
			<% end %>
			
			<% if @fields.has_key?('user_name') %>
				<dt><label for="request_patron_name"><%= @fields['user_name'] %></label>:</dt>
				<dd><%= f.text_field :patron_name, :value => @request.patron_name %></dd>
			<% end %>
			
			<% if @fields.has_key?('user_email') %>
				<dt><label for="request_patron_email"><%= @fields['user_email'] %></label>:</dt>
				<dd><%= f.text_field :patron_email, :value => @request.patron_email %></dd>
			<% end %>		
			
			<% if @fields.has_key?('library_id') %>
  				<dt><label for="request_library_id"> <%= @fields['library_id'] %> </label>:</dt>
				<dd><%= f.text_field :library_id %></dd>
			<% end %>
			
			<% if @fields.has_key?('univ_id') %>
  				<dt><label for="request_univ_id"></label><%= @fields['univ_id'] %> </label>:</dd>
				<dd><%= f.text_field :univ_id %></dd>
			<% end %>
			
			<!-- Always have pickup lib field -->
			
			<dt><label for="request_pickup_lib">Pickup Library</label>:</dt>
				<dd><%= select_tag 'request[pickup_lib]', options_for_select( @pickup_libs_hash)  %></dd>
			
			<!-- Have either not_needed or planned_use field but not both -->
			
			<% if @fields.has_key?('not_needed') %>
			<dt><label for="request_not_needed"><%= @fields['not_needed'] %></label>:</dt>
				<dd><%= f.text_field :not_needed_after %></dd>
			<% elsif @fields.has_key?('planned_use') %>
			<dt><label for="request_planned_use"><%= @fields['planned_use'] %></label>:</dt>
				<dd><%= f.text_field :planned_use %></dd>			
			<% end %>
			
			<% if @fields.has_key?('vol_num') %>
			<dt><label for="request_vol_num"><%= @fields['vol_num'] %></label>:</dt>
			<dd><%= f.text_field :vol_num %></dd>
			<% end %>
			
			<% if @fields.has_key?('comments') %>
			<dt><label for="request_comments"><%= @fields['comments'] %></label>:</dt>
				<dd><%= f.text_area :comments %></dd>
			<% end %>			
			
			</fieldset>
			
	
		
		<fieldset> <legend>Volumes/Copies Required</legend> 
		
		<% @request.items.each do |a|  %>
  		<%	puts a[0]					%>
		<%  call_num = ''               %>
		<%  home_lib = ''               %>
  		<%		a[1].each{ |k,v|		%>
		<%      if k == :home_lib       %>
		<%       home_lib = v          %>                       
     	<%		elsif  k == :call_num	%>
       	<%        call_num = v          %> 
     	<%      end                     %>
     	<%} %>
		<%= home_lib %> <%= call_num    %><br>
		<% end %>
		
		
		</fieldset>
		
		<div class="submit">
			<%= submit_tag "Submit Request"  %>
			<a href="javascript:history.go(-1)">Cancel Request</a>
		</div>
			
		<% end %>		
		
		<div class="closing">
		<p><%= @requestdef[:final_text]%></p>
		</div>


</div>
		
<div id="footer">

© Stanford University. 450 Serra Mall, Stanford, California 94305. (650) 723-2300. <a href="http://library.stanford.edu/about_sulair/termsofuse.html">Terms of Use</a> | <a href="http://www.stanford.edu/home/atoz/copyright.html">Copyright Complaints</a></div>
</body>
</html>		