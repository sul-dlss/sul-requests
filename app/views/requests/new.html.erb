<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title><%= @requestdef[:title] %></title>
		<style type="text/css">
<!--
 .container{ width:700px; border:1px; position:relative;}
 .cell1{float:left; width: 20%; text-align: right; }
 .cell2{float:right; width:78%; text-align: left; }
-->
</style>
	</head>
	<body>
		
		<!-- Parameter names need to match what's used in destination proc -->
		
		<h1><%= @requestdef[:title] %></h1>
		<% unless flash[:notice].blank?%>
			<div id="notification"><%= flash[:notice] %></div>
		<% end %>
		<%= error_messages_for 'request' %>
		
		<%= @requestdef[:initial_text]%>
		
		<% form_for (:request, @request, :url => { :action => 'create'}) do |f| %>
					
			
			<%= f.hidden_field :req_type %>

			<%= f.hidden_field :home_lib %>
			<%= f.hidden_field :current_loc %>
			<%= f.hidden_field :item_id %>
			<%= f.hidden_field :call_num %>
			<%= f.hidden_field :due_date %>
		<table>
			
			<% if @fields.has_key?('ckey') %>
			<tr>			
				<td nowrap valign="top" align="right">Catalog Record ID:</td>
			 	<td valign="top"><%= @request.ckey %></td>
			 <tr>
			 <%= f.hidden_field :ckey %>	
			 <% end %>
			 
			 <tr>
				<td nowrap valign="top" align="right">Call Number:</td>
				 <td valign="top"><%= @request.call_num %></td>
			</tr>
			<tr>
				<td nowrap valign="top" align="right">Date:</td>
				<td valign="top"> <%= Time::now() %></td>
			</tr>
			<tr>
				<td nowrap valign="top" align="right">Item: </td>
				<td valign="top"><%= @request.item %></td>
			</tr>
			
			<% if @fields.has_key?('user_name') %>
			<tr>
				<td nowrap valign="top" align="right">Your name: </td>
				<td valign="top"><%= f.text_field :patron_name, :value => @request.patron_name %></td>
			</tr>
			<% end %>
			
			<% if @fields.has_key?('user_email') %>
			<tr>
				<td nowrap valign="top" align="right">Your e-mail: </td>
				<td valign="top"><%= f.text_field :patron_email, :value => @request.patron_email %></td>
			</tr>	
			<% end %>		
			
			<tr>
  				<td nowrap valign="top" align="right">Library ID: </td>
				<td valign="top"><%= f.text_field :library_id %></td>
			</tr>
			
			<tr>
				<td nowrap valign="top" align="right">Pick-up Library: </td>
				<td valign="top"><%= select_tag 'request[pickup_lib]', options_for_select( @pickup_libs_hash)  %></td>
			</tr>
			<tr>			
				<td nowrap valign="top" align="right">Not Needed After: </td>
				<td valign="top"><%= f.text_field :not_needed_after %></td>
			</tr>
			<tr>		
				<td colspan=2><%= submit_tag "Submit Request"  %></td>
			</tr>
			</table>
			
		<% end %>	
		
		<%= @requestdef[:final_text]%>
		
	</body>
</html>

