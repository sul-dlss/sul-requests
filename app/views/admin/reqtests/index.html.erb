<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
		<title>Request Tests</title>
	</head>
	<body>
		<%= render :partial => 'header' %> 
		<h1>Request Tests</h1>
		
		
		
<p></p>

<table>
	<tr><td width = 150></td><td>
<P>The list below shows information about test records, including links to the Zaph version of the 
record and to forms generated by the Symphony Requests application. The first section 
indicates which request definitions are represented by at least one test record.
<P>
	<hr>
	Request definitions covered by tests: <font color="green"><%= @coverage[0] %></font><br>
	Request definitions not covered by tests: <font color="red"><%= @coverage[1] %></font>
	<hr>
</P> 
</P>
<% for reqtest in @reqtests %>
 
	<% url_data = parse_soc_url(reqtest.socrates_link ) %>
	<% data_req_def = get_req_def( url_data[:home_lib], url_data[:current_loc], url_data[:req_type] ) %>
	<% soc_url = "http://library.stanford.edu/seaz=" + url_data[:ckey] %>
	<% rails_server_url = "http://rd-requests.stanford.edu/requests/new?ckey=" + url_data[:ckey] + "&call_num=" + url_data[:call_num] + "&req_type=" + url_data[:req_type] + "&home_lib=" + url_data[:home_lib] + "&current_loc=" + url_data[:current_loc] + "&item_id=" + url_data[:item_id] + "&due_date=" + url_data[:due_date]  %>
	<% localhost_url = "http://localhost:3000/requests/new?ckey=" + url_data[:ckey] + "&call_num=" + url_data[:call_num] + "&req_type=" + url_data[:req_type] + "&home_lib=" + url_data[:home_lib] + "&current_loc=" + url_data[:current_loc] + "&item_id=" + url_data[:item_id] + "&due_date=" + url_data[:due_date]  %>

	<table border=0>
    	<tr><td colspan = 5>Request Definition: 
    		<% if data_req_def == 'UNDEFINED' %>
    			<font color="red"><%= data_req_def %></font>
			<% else %>	
				<font color="green"><%= data_req_def %></font>
			<% end %>
			</td>
			<td nowrap width><%= button_to 'Edit',{:action => 'edit', :id => reqtest.id }, :method => :get %></td> 
    		<td nowrap><%= button_to 'Delete', { :action => 'destroy', :id => reqtest.id }, :confirm => 'Are you sure you want to delete this item?', 
         :method => :delete %></td>
		</tr>
		<tr><td colspan = 6>CKEY: <%=h url_data[:ckey] %></td></tr>
		<tr>
    		<td width=150>Library: <%= url_data[:home_lib] %></td>
			<td width= 20>&nbsp;</td>				
    		<td width=250>Home Location:</td>
			<td width= 20>&nbsp;</td>				
    		<td width=250 colspan=3>Current Location: <%=h url_data[:current_loc] %> </td>
			<td></td>
		</tr>		
		<tr>	
    		<td colspan=6>Request Type: <%=h url_data[:req_type] %></td>
		</tr>	
		<tr>			
    		<td><a href="<%= soc_url %>">Zaph Record</a></td>
			<td width= 20>&nbsp;</td>				
    		<td><a href="<%= rails_server_url %>">Rails Server Form</a></td>
			<td width= 20>&nbsp;</td>				
			<td><a href="<%= localhost_url %>">Rails Localhost Form</a></td>
			<td></td>
		</tr>
		<tr>
			<td colspan=6>Form Display Status: 
			<% if reqtest.form_status == 'OK' %>
				<font color ="green"><%=h reqtest.form_status %></font>
			<% elsif reqtest.form_status == 'NOT OK' %>
				<font color ="red"><%=h reqtest.form_status %></font>
			<% else %>	
				<%=h reqtest.form_status %>
			<% end %>
			</td>
		</tr>
		<tr>
			<td colspan=6>Request Placed Status:
						<% if reqtest.request_status == 'OK' %>
				<font color ="green"><%=h reqtest.request_status %></font>
			<% elsif reqtest.request_status == 'NOT OK' %>
				<font color ="red"><%=h reqtest.request_status %></font>
			<% else %>	
				<%=h reqtest.request_status %>
			<% end %>	 
		</tr>	
		<tr>			
    		<td colspan =4>Comments: <%=h reqtest.comments %></td>
		</tr>
		<tr><td colspan=7><hr></td></tr>
	</table>			


<% end %>
</td></tr>
</table>


	</body>
</html>
